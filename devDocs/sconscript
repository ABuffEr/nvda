###
#This file is a part of the NVDA project.
#URL: http://www.nvaccess.org/
#Copyright 2019 NV Access Limited.
#This program is free software: you can redistribute it and/or modify
#it under the terms of the GNU General Public License version 2.0, as published by
#the Free Software Foundation.
#This program is distributed in the hope that it will be useful,
#but WITHOUT ANY WARRANTY; without even the implied warranty of
#MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
#This license can be found at:
#http://www.gnu.org/licenses/old-licenses/gpl-2.0.html
###

Import("env", "outputDir", "t2tBuildConf")

devDocsInstall = env.SConscript("devDocsInstall/sconscript", exports=["env"])
env.Depends(devDocsInstall, env.Dir("devDocs/devDocsInstall/requirements.txt"))
env.Alias("devDocsInstall", devDocsInstall)

devDocsOutputDir=outputDir.Dir('devDocs')

#And also build the developer guide -- which must be moved at some point
htmlFile=env.txt2tags('developerGuide.t2t')
env.Depends(htmlFile, t2tBuildConf)
env.SideEffect('_txt2tags',htmlFile)
devGuide=env.Command(devDocsOutputDir.File('developerGuide.html'),htmlFile,Move('$TARGET','$SOURCE'))
env.Alias("developerGuide",devGuide)

devDocs_nvdaHelper_temp=env.Doxygen(source='../nvdaHelper/doxyfile')
devDocs_nvdaHelper=env.Command(devDocsOutputDir.Dir('nvdaHelper'),devDocs_nvdaHelper_temp,Move('$TARGET','$SOURCE'))
env.Alias('devDocs_nvdaHelper', devDocs_nvdaHelper)
env.Clean('devDocs_nvdaHelper', devDocs_nvdaHelper)

#devDocs_nvda = env.Command(devDocsOutputDir.Dir("nvda"), None, [[
#	"cd", sourceDir.path, "&&",
#	sys.executable, "-c", "import sourceEnv; from epydoc.cli import cli; cli()",
#	"--output", "${TARGET.abspath}",
#	"--quiet", "--html", "--include-log", "--no-frames",
#	"--name", "NVDA", "--url", "https://www.nvaccess.org/",
#	"*.py", "appModules", "brailleDisplayDrivers", r"comInterfaces\__init__.py",
#	"config", "contentRecog", "extensionPoints", "globalPlugins", "gui", "mathPres", "NVDAObjects",
#	"speechDictHandler", "synthDrivers", "textInfos", "virtualBuffers",
#]])

#env.Alias('devDocs', [devGuide, devDocs_nvda])
#env.Clean('devDocs', [devGuide, devDocs_nvda])

